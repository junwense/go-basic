任务调度
这个主要是用于任务调度设计，任务调度设计分为几种模式
1.主节点调度
可观测性很好，调度任务很清晰，但是容易成为瓶颈
2.各个节点对等模式竞争
任务生成比较依赖其他模块，依赖各个节点并发竞争分布式锁来获取任务，具体执行任务的流程比较难确定和保证
3.主节点集群调度

这里主要是讨论怎么选择最佳节点调度任务的问题。

任务执行所需资源，这个就和负载均衡各个请求所需资源不同，导致哪怕使用负载均衡，依旧很难找到合适的节点一样，因为可能一个机器只有10个请求打过去，但是每个请求处理超慢，这样服务端负载也会很高

对等模式需要节点在开始过去任务时，检测自己是否能够执行任务，这个时候需要任务生成方在生成时大致指定任务所需的资源，（这里其实可以考虑引入算力的概念，比方说一台2g16内存的机器执行算力是多少），简单的只能靠经验，或者是说当前服务器的负载。

假设当前服务器为一台业务服务器，需要预留部分资源执行业务，所以可以检测当前服务的cpu负载，内存负载，当前服务的http连接数，平均响应时间，比较宽松的策略是cpu60，内存60，http连接数不超过60，平均响应时间正常，没有达到阈值或者报错率接近1%

在确认当前节点无误时，开始获取任务，
如果说任务获取后执行的时候节点负载高了，或者需要任务中断更换节点

这个问题要看任务是否存在允许，正常当节点开始执行任务后，除非通过gofunc异步检测当前节点是否负载，然后通知任务线程，正常是很难中断的的，所以一般是要有自动检测机制，把任务执行流程放到闭包里执行。
任务要能够步骤拆分和分步提交，
如果是数据强一致行的分布式事务的任务，做好在开始时申请够资源并且保证独立集群，因为这类job很难中断和重新调度
简单的数据生成，离线计算，需要做到幂等调用

如果任务异常中断了，这里只要考虑的是对等模式的续约来检测的，当任务中断了，当前机器所抢占的任务是没有租约的（这里最好不要支持重入这种设计），这个时候需要其他节点能够检测到异常任务，重新开始任务，主要是通过runing status和 续约时间来检测。

简单的方案可以在获取任务的时候检测当前的负载，根据负载调整获取任务的数量，再加上当前机器正在执行的任务数量结合判断，如果任务失败，看任务类型是否允许机器重试，还是说需要告警人工判断后处理。